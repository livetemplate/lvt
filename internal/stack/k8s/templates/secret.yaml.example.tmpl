# This is an EXAMPLE secret file. DO NOT commit actual secrets to git!
# Create the actual secret with: kubectl create secret generic {{ .ProjectName }}-secret --from-literal=...

apiVersion: v1
kind: Secret
metadata:
  name: {{ .ProjectName }}-secret
  namespace: {{ .Namespace }}
  labels:
    app: {{ .ProjectName }}
    managed-by: lvt
type: Opaque
stringData:
  {{- if eq .Database "postgres" }}
  # Replace with your actual Postgres connection string
  database-url: "postgres://user:password@postgres-host:5432/dbname?sslmode=require"
  {{- end }}
  {{- if ne .Redis "none" }}
  # Replace with your actual Redis connection string
  redis-url: "redis://user:password@redis-host:6379"
  {{- end }}
  {{- if ne .Storage "none" }}
  {{- if eq .Storage "s3" }}
  # Replace with your actual AWS credentials
  storage-access-key: "YOUR_AWS_ACCESS_KEY_ID"
  storage-secret-key: "YOUR_AWS_SECRET_ACCESS_KEY"
  {{- if eq .Backup "litestream" }}
  aws-access-key-id: "YOUR_AWS_ACCESS_KEY_ID"
  aws-secret-access-key: "YOUR_AWS_SECRET_ACCESS_KEY"
  {{- end }}
  {{- else if eq .Storage "b2" }}
  # Replace with your actual B2 credentials
  storage-access-key: "YOUR_B2_KEY_ID"
  storage-secret-key: "YOUR_B2_APPLICATION_KEY"
  {{- if eq .Backup "litestream" }}
  b2-application-key-id: "YOUR_B2_KEY_ID"
  b2-application-key: "YOUR_B2_APPLICATION_KEY"
  {{- end }}
  {{- else if eq .Storage "do-spaces" }}
  # Replace with your actual DO Spaces credentials
  storage-access-key: "YOUR_DO_SPACES_KEY"
  storage-secret-key: "YOUR_DO_SPACES_SECRET"
  {{- end }}
  {{- end }}

---
# To create this secret in your cluster, use one of these methods:

# Method 1: kubectl create secret
# kubectl create secret generic {{ .ProjectName }}-secret \
#   --namespace={{ .Namespace }} \
{{- if eq .Database "postgres" }}
#   --from-literal=database-url='postgres://...' \
{{- end }}
{{- if ne .Redis "none" }}
#   --from-literal=redis-url='redis://...' \
{{- end }}
{{- if ne .Storage "none" }}
#   --from-literal=storage-access-key='YOUR_KEY' \
#   --from-literal=storage-secret-key='YOUR_SECRET'
{{- end }}

# Method 2: Use a secrets management tool like:
#   - Sealed Secrets (https://github.com/bitnami-labs/sealed-secrets)
#   - External Secrets Operator (https://external-secrets.io)
#   - HashiCorp Vault
#   - Cloud provider secret managers (AWS Secrets Manager, GCP Secret Manager, Azure Key Vault)
